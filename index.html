<!doctype html>
<!--
  Panel de Fichaje (PWA) ‚Äî Smouj013
  Vista general: lista de empleados + fichaje por fila + horario semanal
-->
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#0b0b10" />
  <meta name="description" content="Panel de fichaje: empleados, turnos semanales y fichaje por d√≠a con entrada/salida." />

  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="stylesheet" href="./styles.css" />

  <title>Panel de Fichaje ‚Äî Smouj013</title>
</head>

<body>
  <noscript>
    <div class="noscript">Necesitas JavaScript activado para usar esta app.</div>
  </noscript>

  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo">üïí</div>
        <div class="brandText">
          <div class="title" id="companyName">Panel de Fichaje</div>
          <div class="sub" id="subTitle">Vista general</div>
        </div>
      </div>

      <div class="topActions">
        <button class="btn ghost" id="btnExportDay" type="button" title="Exportar d√≠a">‚¨áÔ∏è D√≠a</button>
        <button class="btn ghost" id="btnExportWeek" type="button" title="Exportar semana">‚¨áÔ∏è Semana</button>
        <button class="btn ghost" id="btnSettings" type="button" title="Ajustes">‚öôÔ∏è</button>
      </div>
    </header>

    <main class="main">
      <section class="card controls">
        <div class="controlsRow">
          <div class="dateBox">
            <div class="label">Fecha</div>
            <div class="dateRow">
              <button class="btn" id="btnPrevDay" type="button">‚óÄ</button>
              <input class="input" id="datePicker" type="date" />
              <button class="btn" id="btnNextDay" type="button">‚ñ∂</button>
              <button class="btn ghost" id="btnToday" type="button">Hoy</button>
            </div>
            <div class="hint" id="dateHint">‚Äî</div>
          </div>

          <div class="searchBox">
            <div class="label">Buscar</div>
            <div class="searchRow">
              <input class="input" id="searchInput" placeholder="Filtrar por nombre‚Ä¶" maxlength="40" />
              <button class="btn ghost" id="btnClearSearch" type="button" title="Limpiar b√∫squeda">‚úï</button>
            </div>
            <div class="hint">Tip: escribe ‚Äúana‚Äù, ‚Äúcarlos‚Äù‚Ä¶</div>
            <div class="filterGroup" role="group" aria-label="Filtrar por estado">
              <button class="btn filterBtn active" type="button" data-filter="all">
                Todos <span class="filterCount" id="filterAllCount">‚Äî</span>
              </button>
              <button class="btn filterBtn" type="button" data-filter="inside">
                Dentro <span class="filterCount" id="filterInsideCount">‚Äî</span>
              </button>
              <button class="btn filterBtn" type="button" data-filter="onShift">
                En turno <span class="filterCount" id="filterOnShiftCount">‚Äî</span>
              </button>
              <button class="btn filterBtn" type="button" data-filter="noShift">
                Sin turno <span class="filterCount" id="filterNoShiftCount">‚Äî</span>
              </button>
              <button class="btn filterBtn" type="button" data-filter="completed">
                Completos <span class="filterCount" id="filterCompletedCount">‚Äî</span>
              </button>
            </div>
          </div>
        </div>
      </section>

      <section class="card summaryCard">
        <div class="cardHead">
          <div>
            <div class="cardTitle">Resumen del d√≠a</div>
            <div class="cardSub" id="summarySub">‚Äî</div>
          </div>
          <div class="summaryHint">Actualizaci√≥n en tiempo real</div>
        </div>
        <div class="summaryGrid">
          <div class="summaryItem accent-primary">
            <div class="summaryLabel">Empleados</div>
            <div class="summaryValue" id="summaryTotal">‚Äî</div>
            <div class="summaryMeta">Activos hoy</div>
          </div>
          <div class="summaryItem accent-ok">
            <div class="summaryLabel">Dentro</div>
            <div class="summaryValue" id="summaryInside">‚Äî</div>
            <div class="summaryMeta">En la oficina</div>
          </div>
          <div class="summaryItem accent-warn">
            <div class="summaryLabel">En turno</div>
            <div class="summaryValue" id="summaryOnShift">‚Äî</div>
            <div class="summaryMeta">Sin fichar</div>
          </div>
          <div class="summaryItem accent-muted">
            <div class="summaryLabel">Sin turno</div>
            <div class="summaryValue" id="summaryNoShift">‚Äî</div>
            <div class="summaryMeta">Sin horario</div>
          </div>
          <div class="summaryItem accent-info">
            <div class="summaryLabel">Fichajes completos</div>
            <div class="summaryValue" id="summaryCompleted">‚Äî</div>
            <div class="summaryMeta">Entrada y salida</div>
          </div>
          <div class="summaryItem accent-primary">
            <div class="summaryLabel">Horas registradas</div>
            <div class="summaryValue" id="summaryHours">‚Äî</div>
            <div class="summaryMeta">Total del d√≠a</div>
          </div>
        </div>
      </section>

      <section class="card listCard">
        <div class="listHead">
          <div class="listTitle">
            <div class="cardTitle">Empleados</div>
            <div class="cardSub" id="listSub">‚Äî</div>
          </div>

          <div class="listLegend">
            <span class="chip chip-ok">‚óè Dentro</span>
            <span class="chip chip-warn">‚óè En turno (sin fichar)</span>
            <span class="chip chip-muted">‚óè Sin turno</span>
          </div>
        </div>

        <div class="tableWrap" role="region" aria-label="Lista de empleados">
          <div class="tableHead">
            <div>Empleado</div>
            <div>Turno de hoy</div>
            <div>Entrada</div>
            <div>Salida</div>
            <div>Horas</div>
            <div>Acci√≥n</div>
          </div>

          <div class="tableBody" id="employeeList"></div>
        </div>
      </section>

      <section class="card logsCard">
        <div class="cardHead">
          <div>
            <div class="cardTitle">Registro</div>
            <div class="cardSub">Eventos del d√≠a seleccionado (append-only)</div>
          </div>
          <div class="cardActions">
            <button class="btn ghost" id="btnClearDay" type="button">Borrar fichajes del d√≠a</button>
          </div>
        </div>

        <div class="events" id="events"></div>
      </section>
    </main>

    <footer class="footer">
      <div class="footLeft">
        <span class="pill">PWA</span>
        <span class="pill">Offline</span>
        <span class="pill">Smouj013</span>
      </div>
      <div class="footRight">
        <button class="link" id="btnInstall" type="button" hidden>Instalar</button>
      </div>
    </footer>
  </div>

  <!-- Modal Ajustes -->
  <div class="modalBackdrop" id="settingsBackdrop" hidden></div>
  <div class="modal" id="settingsModal" hidden role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
    <div class="modalHead">
      <div>
        <div class="modalTitle" id="settingsTitle">Ajustes</div>
        <div class="modalSub">Empresa, empleados y horarios semanales</div>
      </div>
      <button class="btn ghost" id="btnCloseSettings" type="button">‚úï</button>
    </div>

    <div class="modalBody">
      <div class="grid2">
        <label class="field">
          <span>Empresa</span>
          <input class="input" id="inpCompany" placeholder="Ej: Mi Empresa S.L." maxlength="40" />
        </label>

        <label class="field row">
          <span>Solicitar PIN para exportar/borrar</span>
          <input type="checkbox" id="chkPin" />
        </label>
      </div>

      <label class="field">
        <span>PIN (4‚Äì10 d√≠gitos)</span>
        <input class="input" id="inpPin" inputmode="numeric" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="10" />
        <div class="hint">Si activas el PIN, se pedir√° para exportar y borrar.</div>
      </label>

      <div class="divider"></div>

      <div class="cardMini">
        <div class="miniHead">
          <div>
            <div class="miniTitle">Empleados</div>
            <div class="miniSub">A√±ade, edita y define su horario semanal.</div>
          </div>
        </div>

        <div class="addRow">
          <input class="input" id="inpNewEmployee" placeholder="Nombre del empleado" maxlength="40" />
          <input class="input color" id="inpNewColor" type="color" value="#6ee7ff" />
          <button class="btn primary" id="btnAddEmployee" type="button">A√±adir</button>
        </div>

        <div class="empAdminList" id="empAdminList"></div>
      </div>

      <div class="smallNote">
        Nota: esto funciona local (offline). Para uso real de empresa necesitar√≠as servidor y usuarios.
      </div>
    </div>

    <div class="modalFoot">
      <button class="btn ghost" id="btnCancelSettings" type="button">Cerrar</button>
      <button class="btn primary" id="btnSaveSettings" type="button">Guardar</button>
    </div>
  </div>

  <!-- Modal editar horario -->
  <div class="modalBackdrop" id="editBackdrop" hidden></div>
  <div class="modal" id="editModal" hidden role="dialog" aria-modal="true" aria-labelledby="editTitle">
    <div class="modalHead">
      <div>
        <div class="modalTitle" id="editTitle">Editar horario</div>
        <div class="modalSub" id="editSub">‚Äî</div>
      </div>
      <button class="btn ghost" id="btnCloseEdit" type="button">‚úï</button>
    </div>

    <div class="modalBody">
      <div class="scheduleTools">
        <button class="btn" id="btnTemplateWeek" type="button">Plantilla 09:00‚Äì17:00 (L‚ÄìV)</button>
        <button class="btn ghost" id="btnClearSchedule" type="button">Vaciar horario</button>
      </div>

      <div class="scheduleGrid" id="scheduleGrid"></div>

      <div class="field">
        <span>Nota interna (opcional)</span>
        <input class="input" id="inpEmpNote" maxlength="80" placeholder="Ej: Media jornada, turno partido‚Ä¶" />
      </div>
    </div>

    <div class="modalFoot">
      <button class="btn ghost" id="btnCancelEdit" type="button">Cancelar</button>
      <button class="btn primary" id="btnSaveEdit" type="button">Guardar</button>
    </div>
  </div>

  <script defer src="./app.js"></script>
</body>
</html>
